<ion-header no-border>

  <div class="cabeceraGeneral">

    <div style="display: inline; width: 5%;"></div>

    <div style="display: inline; width: 10%;border-color: white; border: solid 1px;margin: 5px;">Es</div>

    <div style="width: 60%; height: 100%; display: flex; align-items: center; justify-content: center;">
      <img src="assets/images/titulo.png"
        style="object-fit: scale-down;position: relative; z-index: 10;height: 7vh; margin-top: 0.6rem;margin-left: 8vw;">
    </div>

    <div style="display: inline; width: 10%;text-align: -webkit-right; margin-left: 18px;" (click)="popCart($event)">
      <img src="assets/icon/Carrito-compra.png" style="height: 1.8rem;">
    </div>

    <div style="display: inline; width: 10%" (click)="popMenu($event)">
      <ion-icon name="md-menu" style="font-size: 25px;padding-top: 5px;"></ion-icon>
    </div>

    <div style="display: inline; width: 5%;"></div>

  </div>



  <div class="cabeceraTitulo">
    Devoluciones
  </div>
  <ion-progress-bar type="indeterminate" *ngIf="loading>0" color="secondary"></ion-progress-bar>

</ion-header>

<ion-content>
  <div style="width: 100%;height: 100%; background-color: var(--ion-color-primary);">
    <div style=" height: 100%; background-color: white ;margin: 0px 0px 0px 0px;">
      <ion-grid class=" ion-no-padding ion-no-margin" style="height: 100%;">
        <ion-row class=" ion-no-padding  ion-no-margin ion-justify-content-center" style="height: 100%">
          <ion-col class=" ion-no-padding ion-no-margin" size="12" style="text-align: center;">
            <div>
              <ion-row>
                <ion-text color="primary">
                  <p>Debe seleccionar el o los boletos que desea devolver. La devolución debe ser realizada por lo menos
                    4
                    hrs antes de la salida del servicio</p>
                  <p style="padding: 0 1rem;">* Si la compra se Realizó con tarjeta de crédito, se generará una reversa
                    en su cuenta, si se realizó
                    con tarjeta de débito, se realizaréá una transferencia a la cuenta que entregue para este fin. La
                    devolucion o reversa se hará en un plazo máximo de 6 días hábiles.</p>
                </ion-text>
              </ion-row>

              <ion-row>
                <ion-col size="6">
                  <div class="overIonInput">
                    <ion-input type="text" placeholder="Orden" [(ngModel)]="orden"
                      #numeroDeCuenta name='orden'></ion-input>
                  </div>
                </ion-col>
                <ion-col size="6">
                  <ion-button
                    style="width: -webkit-fill-available; transform: none;--background:var(--ion-color-secondary);margin: 0px;"
                    (click)="buscarBoletos()">
                    <div>Consultar</div>
                  </ion-button>
                </ion-col>
              </ion-row>

              <!-- linea1 -->
              <ion-row *ngIf="boletosAll.length > 0">
                <ion-col size="6" *ngIf="boletosAll[0].tipoCompra === 'VN'">
                  <ion-select [interfaceOptions]="tipoDeCuentaOptions" class=" ion-no-padding ion-no-margin"
                    multiple="false" placeholder="Tipo de Cuenta" cancel-text="Cancelar"
                    [(ngModel)]="myData.tipoDeCuenta" #tipoDeCuenta name='tipoDeCuenta' required>
                    <ion-select-option *ngFor="let tipoDeCuenta of myData.tiposDeCredito"
                      value="{{tipoDeCuenta.codigo}}">
                      {{tipoDeCuenta.nombre}}
                    </ion-select-option>
                  </ion-select>
                </ion-col>
                <ion-col size="6" *ngIf="boletosAll[0].tipoCompra === 'VD'">
                  <ion-select [interfaceOptions]="tipoDeCuentaOptions" class=" ion-no-padding ion-no-margin"
                    multiple="false" placeholder="Tipo de Cuenta" cancel-text="Cancelar"
                    [(ngModel)]="myData.tipoDeCuenta" #tipoDeCuenta name='tipoDeCuenta' required>
                    <ion-select-option *ngFor="let tipoDeCuenta of myData.tiposDeCuentas"
                      value="{{tipoDeCuenta.codigo}}">
                      {{tipoDeCuenta.nombre}}
                    </ion-select-option>
                  </ion-select>
                </ion-col>
                <ion-col size="6" *ngIf="boletosAll[0].tipoCompra === 'VD'">
                  <div class="overIonInput">
                    <ion-input type="text" placeholder="Número de Cuenta" [(ngModel)]="myData.numeroDeCuenta"
                      #numeroDeCuenta name='numeroDeCuenta'></ion-input>
                  </div>
                </ion-col>
              </ion-row>
              <!-- linea2 -->
              <ion-row *ngIf="boletosAll.length > 0">
                <ion-col size="6" *ngIf="boletosAll[0].tipoCompra === 'VD'">
                  <ion-select [interfaceOptions]="bancoOptions" class=" ion-no-padding ion-no-margin" multiple="false"
                    placeholder="Banco" cancel-text="Cancelar" [(ngModel)]="myData.banco" #banco name='banco' required>
                    <ion-select-option *ngFor="let banco of this.myData.bancos" value="{{banco.codigo}}">
                      {{banco.nombre}}
                    </ion-select-option>
                  </ion-select>
                </ion-col>
                <ion-col size="6" *ngIf="boletosAll[0].tipoCompra === 'VD'">
                  <div class="overIonInput">
                    <ion-input type="text" placeholder="RUT del titular de la cuenta" [(ngModel)]="myData.rutTitular"
                      #rutTitular name='rutTitular'></ion-input>
                  </div>
                </ion-col>
              </ion-row>
            </div>

            <ion-row class=" ion-no-padding ion-no-margin" class="ticket"
              *ngFor="let boleto of boletosAll;  let i=index">
              <ion-row class=" ion-no-padding ion-no-margin" style="width: 100%;">
                <ion-col size="3" class=" ion-no-padding ion-no-margin" class="cabeceraCadaTicket">Origen/Terminal
                </ion-col>
                <ion-col size="3" class=" ion-no-padding ion-no-margin" class="cabeceraCadaTicket">Destino/Terminal
                </ion-col>
                <ion-col size="3" class=" ion-no-padding ion-no-margin" class="cabeceraCadaTicket">Fecha/Hora Salida
                </ion-col>
                <ion-col size="2" class=" ion-no-padding ion-no-margin" class="cabeceraCadaTicket">Asiento</ion-col>
                <ion-col size="1" class=" ion-no-padding ion-no-margin" class="cabeceraCadaTicket"></ion-col>                
              </ion-row>

              <ion-row class=" ion-no-padding ion-no-margin" style="width: 100%;">
                <ion-col size="3" class=" ion-no-padding ion-no-margin" class="infoCadaTicket">
                  {{boleto.imprimeVoucher.nombreTerminalOrigen}}</ion-col>
                <ion-col size="3" class=" ion-no-padding ion-no-margin" class="infoCadaTicket">
                  {{boleto.imprimeVoucher.nombreTerminalDestino}}</ion-col>
                <ion-col size="3" class=" ion-no-padding ion-no-margin" class="infoCadaTicket">
                  {{boleto.imprimeVoucher.fechaSalida}}<br>{{boleto.imprimeVoucher.horaSalida}} </ion-col>
                <ion-col size="2" class=" ion-no-padding ion-no-margin" class="infoCadaTicket">
                  {{boleto.imprimeVoucher.asiento}}
                  <img src="assets/icon/png/icono_pata_verde.svg" *ngIf="boleto.tipoServicio === 'pet'"
                  style="width: 2rem;"/>
                </ion-col>
                <ion-col size="1" class=" ion-no-padding ion-no-margin" class="infoCadaTicket">
                  <ion-checkbox     
                    *ngIf="boleto.puedeImprimir"                
                    mode="ios" style="position: relative; left: -7px; height: 5vw; width: 5vw;"
                    [(ngModel)]="boletosAll[i].selected" (ionChange)="checkboxChanged(i)">
                  </ion-checkbox>                  
                </ion-col>
              </ion-row>

            </ion-row>
            <ion-row *ngIf="boletosAll.length > 0">
              <ion-col size="12">
                <ion-button
                  style="width: -webkit-fill-available; transform: none;--background:var(--ion-color-secondary);margin: 0px;"
                  (click)="anular()">
                  <div>Anular</div>
                </ion-button>
              </ion-col>
            </ion-row>
          </ion-col>
        </ion-row>
      </ion-grid>
    </div>
  </div>
</ion-content>

<ion-footer>
  <div
    style=" width: 100%; display: flex;align-items: center;justify-content: center; background-color: var(--ion-color-primary);">

    <ion-button fill="clear" style="color: white;  width: 50%; outline: none;" routerLink="/ticket-management">
      <ion-icon src="assets/icon/previous.svg"></ion-icon>
      <div style="display: inline; text-align: left ;padding-left: 10px; text-transform: none;">Regresar</div>
    </ion-button>

  </div>
</ion-footer>